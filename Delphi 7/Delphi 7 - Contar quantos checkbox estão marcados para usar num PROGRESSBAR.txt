function TForm1.ContarCheckboxesMarcados: Integer;

{ CAZ 19/02/2015: Função utilizada para alimentar o ProgressBar 2 mostrando ao programador, além das informações
  dos processos no ProgressBar1, o andamento da migração das ABAS da planilha Excel. Esta função não considera o
  checkbox do botão "Limpa". Os demais checkbox do form que não são referentes às abas também não são considerados
  por estarem desabilitados. Caso algum dia um deles seja habilitado será necessário excluí-lo na função abaixo.  }

var
  i, marcados: integer;
begin
  marcados := 0;
  for i := 0  to ComponentCount -1 do
  begin
    {Se o componente não for o combobox "Limpa"}
    if Components[ i ].Name <> 'cbLimpa' then
    begin
      {Realiza uma contagem de quantos foram selecionados. Esta informação será utilizada no segundo ProgressBar}
      if ( Components[ i ] is TCheckBox ) and ( ( Components[ i ] as TCheckbox ).Checked ) then
      begin
        inc( marcados );
      end;
    end;
  end;
  result := marcados;
end;


Para usar no progressbar:


  ProgressBar2.Position := 0;
  ProgressBar2.Max      := ContarCheckboxesMarcados;
  ProgressBar2.Position := ProgressBar2.Position + 1;
